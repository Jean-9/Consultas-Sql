{"ast":null,"code":"import{useEffect,useRef,useState}from\"react\";import{Streamlit}from\"streamlit-component-lib\";import AceEditor from\"react-ace\";import{Paper}from\"@material-ui/core\";import{MuiThemeProvider,createTheme}from\"@material-ui/core/styles\";import\"ace-builds/webpack-resolver\";import\"ace-builds/src-min-noconflict/ext-emmet\";import\"ace-builds/src-min-noconflict/ext-language_tools\";import\"./index.css\";// Aqui está o estilo visual para deixar o texto em maiúsculo\nimport{jsx as _jsx}from\"react/jsx-runtime\";const Ace=_ref=>{let{args,theme}=_ref;const[colors,setColors]=useState({});const[changed,setChanged]=useState(false);const editorRef=useRef(null);const debounceRef=useRef(0);let timeout;// Send editor content to streamlit\nconst updateStreamlit=value=>{Streamlit.setComponentValue(value.toUpperCase());// força o valor em maiúsculo\nsetChanged(false);};// Called on editor update\nconst handleChange=value=>{clearTimeout(timeout);timeout=setTimeout(()=>{if(args.autoUpdate){updateStreamlit(value);}else{setChanged(true);}},debounceRef.current);};// Update content keybinding\nuseEffect(()=>{if(!editorRef.current)return;const editor=editorRef.current.editor;editor.commands.removeCommand(\"addLineAfter\");editor.commands.addCommand({name:\"updateStreamlit\",bindKey:{mac:\"cmd-return\",win:\"ctrl-return\"},exec:editor=>{if(args.autoUpdate){editor.selection.clearSelection();editor.navigateLineEnd();editor.insert(\"\\n\");}else if(changed){updateStreamlit(editor.getValue());}}});debounceRef.current=args.autoUpdate?200:0;// 🔧 Setup custom autocomplete\nif(args.completer&&Array.isArray(args.completer)){const customCompleter={getCompletions:function(editor,session,pos,prefix,callback){const line=session.getLine(pos.row);const cursorColumn=pos.column;const textBeforeCursor=line.substring(0,cursorColumn);// Extrai a última \"palavra\" válida (para prefixo real)\nconst match=textBeforeCursor.match(/(\\w+)$/);const lastWord=(match?match[1]:\"\").toUpperCase();const results=args.completer.filter(item=>{const value=(item.value||\"\").toUpperCase();return value.startsWith(lastWord);}).map(item=>({value:item.value,caption:item.value,meta:item.meta||\"custom\"}));callback(null,results);}};// Sobrescreve todos os completers com apenas o nosso\neditor.completers=[customCompleter];}// 🔠 Força o texto digitado em maiúsculo\n},[]);// <- fim do useEffect\n// Update theme\nuseEffect(()=>{setColors({palette:{primary:{main:theme===null||theme===void 0?void 0:theme.primaryColor,background:{default:theme===null||theme===void 0?void 0:theme.backgroundColor},text:{primary:theme===null||theme===void 0?void 0:theme.textColor}}}});},[theme===null||theme===void 0?void 0:theme.primaryColor,theme===null||theme===void 0?void 0:theme.backgroundColor,theme===null||theme===void 0?void 0:theme.textColor]);// Set default prop values that shouldn't be exposed to python\nargs.enableBasicAutocompletion=true;args.enableLiveAutocompletion=true;args.enableSnippets=true;args.onChange=handleChange;args.width=\"100%\";// Auto height\nif(!args.height){args.maxLines=Infinity;}const resizeObserver=new ResizeObserver(entries=>{Streamlit.setFrameHeight(entries[0].contentRect.height+15);});const observeElement=element=>{if(element!==null)resizeObserver.observe(element);else resizeObserver.disconnect();};return/*#__PURE__*/_jsx(\"div\",{ref:observeElement,children:/*#__PURE__*/_jsx(MuiThemeProvider,{theme:createTheme(colors),children:/*#__PURE__*/_jsx(Paper,{children:/*#__PURE__*/_jsx(AceEditor,{ref:editorRef,...args})})})});};export default withStreamlitConnecti;","map":{"version":3,"names":["useEffect","useRef","useState","Streamlit","AceEditor","Paper","MuiThemeProvider","createTheme","jsx","_jsx","Ace","_ref","args","theme","colors","setColors","changed","setChanged","editorRef","debounceRef","timeout","updateStreamlit","value","setComponentValue","toUpperCase","handleChange","clearTimeout","setTimeout","autoUpdate","current","editor","commands","removeCommand","addCommand","name","bindKey","mac","win","exec","selection","clearSelection","navigateLineEnd","insert","getValue","completer","Array","isArray","customCompleter","getCompletions","session","pos","prefix","callback","line","getLine","row","cursorColumn","column","textBeforeCursor","substring","match","lastWord","results","filter","item","startsWith","map","caption","meta","completers","palette","primary","main","primaryColor","background","default","backgroundColor","text","textColor","enableBasicAutocompletion","enableLiveAutocompletion","enableSnippets","onChange","width","height","maxLines","Infinity","resizeObserver","ResizeObserver","entries","setFrameHeight","contentRect","observeElement","element","observe","disconnect","ref","children","withStreamlitConnecti"],"sources":["C:/Users/jean9/Desktop/projeto_rm/components/streamlit_ace/frontend/src/Ace.tsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\"\nimport {\n  ComponentProps,\n  Streamlit,\n  withStreamlitConnection,\n  Theme,\n} from \"streamlit-component-lib\"\nimport AceEditor from \"react-ace\"\nimport { IAceEditor } from \"react-ace/lib/types\"\nimport { Paper, Button, Grid } from \"@material-ui/core\"\nimport { MuiThemeProvider, createTheme } from \"@material-ui/core/styles\"\n\nimport \"ace-builds/webpack-resolver\"\nimport \"ace-builds/src-min-noconflict/ext-emmet\"\nimport \"ace-builds/src-min-noconflict/ext-language_tools\"\n\nimport \"./index.css\" // Aqui está o estilo visual para deixar o texto em maiúsculo\n\ninterface AceProps extends ComponentProps {\n  args: any\n  theme?: Theme\n}\n\nconst Ace = ({ args, theme }: AceProps) => {\n  const [colors, setColors] = useState<any>({})\n  const [changed, setChanged] = useState<boolean>(false)\n  const editorRef = useRef<IAceEditor>(null)\n  const debounceRef = useRef<number>(0)\n\n  let timeout: NodeJS.Timeout\n\n  // Send editor content to streamlit\n  const updateStreamlit = (value: string) => {\n    Streamlit.setComponentValue(value.toUpperCase()) // força o valor em maiúsculo\n    setChanged(false)\n  }\n\n  // Called on editor update\n  const handleChange = (value: string) => {\n    clearTimeout(timeout)\n\n    timeout = setTimeout(() => {\n      if (args.autoUpdate) {\n        updateStreamlit(value)\n      }\n      else {\n        setChanged(true)\n      }\n    }, debounceRef.current)\n  }\n\n  // Update content keybinding\n  useEffect(() => {\n  if (!editorRef.current) return\n\n  const editor = editorRef.current.editor\n\n  editor.commands.removeCommand(\"addLineAfter\")\n  editor.commands.addCommand({\n    name: \"updateStreamlit\",\n    bindKey: { mac: \"cmd-return\", win: \"ctrl-return\" },\n    exec: (editor: IAceEditor) => {\n      if (args.autoUpdate) {\n        editor.selection.clearSelection()\n        editor.navigateLineEnd()\n        editor.insert(\"\\n\")\n      } else if (changed) {\n        updateStreamlit(editor.getValue())\n      }\n    },\n  })\n\n  debounceRef.current = args.autoUpdate ? 200 : 0\n\n  // 🔧 Setup custom autocomplete\n  if (args.completer && Array.isArray(args.completer)) {\n    const customCompleter = {\n  getCompletions: function (editor: any, session: any, pos: any, prefix: any, callback: any) {\n  const line = session.getLine(pos.row)\n  const cursorColumn = pos.column\n  const textBeforeCursor = line.substring(0, cursorColumn)\n\n  // Extrai a última \"palavra\" válida (para prefixo real)\n  const match = textBeforeCursor.match(/(\\w+)$/)\n  const lastWord = (match ? match[1] : \"\").toUpperCase()\n\n  const results = args.completer\n    .filter((item: any) => {\n      const value = (item.value || \"\").toUpperCase()\n      return value.startsWith(lastWord)\n    })\n    .map((item: any) => ({\n      value: item.value,\n      caption: item.value,\n      meta: item.meta || \"custom\"\n    }))\n\n  callback(null, results)\n}\n}\n\n    // Sobrescreve todos os completers com apenas o nosso\n    editor.completers = [customCompleter]\n  }\n\n  // 🔠 Força o texto digitado em maiúsculo\n\n\n}, [])  // <- fim do useEffect\n\n  // Update theme\n  useEffect(() => {\n    setColors({\n      palette: {\n        primary: {\n          main: theme?.primaryColor,\n          background: {\n            default: theme?.backgroundColor,\n          },\n          text: {\n            primary: theme?.textColor,\n          }\n        }\n      }\n    })\n  }, [theme?.primaryColor, theme?.backgroundColor, theme?.textColor])\n\n\n  // Set default prop values that shouldn't be exposed to python\n  args.enableBasicAutocompletion = true\n  args.enableLiveAutocompletion = true\n  args.enableSnippets = true\n  args.onChange = handleChange\n  args.width = \"100%\"\n\n  // Auto height\n  if (!args.height) {\n    args.maxLines = Infinity\n  }\n\n  const resizeObserver = new ResizeObserver((entries: any) => {\n    Streamlit.setFrameHeight(entries[0].contentRect.height + 15)\n  })\n\n  const observeElement = (element: HTMLDivElement | null) => {\n    if (element !== null)\n      resizeObserver.observe(element)\n    else\n      resizeObserver.disconnect()\n  }\n\n  return (\n    <div ref={observeElement}>\n      <MuiThemeProvider theme={createTheme(colors)}>\n        <Paper>\n          <AceEditor ref={editorRef} {...args} />\n        </Paper>\n\n      </MuiThemeProvider>\n    </div>\n  )\n}\n\nexport default withStreamlitConnecti"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}