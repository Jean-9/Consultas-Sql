{"ast":null,"code":"import{useEffect,useRef,useState}from\"react\";import{Streamlit,withStreamlitConnection}from\"streamlit-component-lib\";import AceEditor from\"react-ace\";import{Paper}from\"@material-ui/core\";import{MuiThemeProvider,createTheme}from\"@material-ui/core/styles\";import\"ace-builds/webpack-resolver\";import\"ace-builds/src-min-noconflict/ext-emmet\";import\"ace-builds/src-min-noconflict/ext-language_tools\";import\"./index.css\";// Aqui estÃ¡ o estilo visual para deixar o texto em maiÃºsculo\nimport{jsx as _jsx}from\"react/jsx-runtime\";const Ace=_ref=>{let{args,theme}=_ref;const[colors,setColors]=useState({});const[changed,setChanged]=useState(false);const editorRef=useRef(null);const debounceRef=useRef(0);let timeout;// Send editor content to streamlit\nconst updateStreamlit=value=>{Streamlit.setComponentValue(value.toUpperCase());// forÃ§a o valor em maiÃºsculo\nsetChanged(false);};// Called on editor update\nconst handleChange=value=>{clearTimeout(timeout);timeout=setTimeout(()=>{if(args.autoUpdate){updateStreamlit(value);}else{setChanged(true);}},debounceRef.current);};// Update content keybinding\nuseEffect(()=>{if(editorRef.current){const editor=editorRef.current.editor;editor.commands.removeCommand(\"addLineAfter\");editor.commands.addCommand({name:\"updateStreamlit\",bindKey:{mac:\"cmd-return\",win:\"ctrl-return\"},exec:editor=>{if(args.autoUpdate){editor.selection.clearSelection();editor.navigateLineEnd();editor.insert(\"\\n\");}else if(changed){updateStreamlit(editor.getValue());}}});debounceRef.current=args.autoUpdate?200:0;// ðŸ‘‡ Completer customizado com filtro por prefixo\nif(args.completer&&Array.isArray(args.completer)){const customCompleter={getCompletions:function(editor,session,pos,prefix,callback){const results=args.completer.filter(item=>{if(!prefix)return true;// se nÃ£o houver prefixo, mostra tudo\nreturn(item.value||\"\").toUpperCase().includes(prefix.toUpperCase());}).map(item=>({value:item.value,caption:item.value,meta:item.meta||\"custom\"}));callback(null,results);}};// Adiciona o completer personalizado Ã  lista de completers existentes\nif(editor.completers&&Array.isArray(editor.completers)){editor.completers.push(customCompleter);}else{editor.completers=[customCompleter];}}// ðŸ”  ForÃ§a sugestÃµes em maiÃºsculo (inclusive nativas se houver)\neditor.completers.forEach(completer=>{const original=completer.getCompletions;completer.getCompletions=function(editor,session,pos,prefix,callback){original.call(this,editor,session,pos,prefix,function(err,results){if(results){results.forEach(item=>{item.value=item.value.toUpperCase();if(item.caption)item.caption=item.caption.toUpperCase();});}callback(err,results);});};});}},[]);// Update theme\nuseEffect(()=>{setColors({palette:{primary:{main:theme===null||theme===void 0?void 0:theme.primaryColor,background:{default:theme===null||theme===void 0?void 0:theme.backgroundColor},text:{primary:theme===null||theme===void 0?void 0:theme.textColor}}}});},[theme===null||theme===void 0?void 0:theme.primaryColor,theme===null||theme===void 0?void 0:theme.backgroundColor,theme===null||theme===void 0?void 0:theme.textColor]);// Set default prop values that shouldn't be exposed to python\nargs.enableBasicAutocompletion=true;args.enableLiveAutocompletion=true;args.onChange=handleChange;args.width=\"100%\";// Auto height\nif(!args.height){args.maxLines=Infinity;}const resizeObserver=new ResizeObserver(entries=>{Streamlit.setFrameHeight(entries[0].contentRect.height+15);});const observeElement=element=>{if(element!==null)resizeObserver.observe(element);else resizeObserver.disconnect();};return/*#__PURE__*/_jsx(\"div\",{ref:observeElement,children:/*#__PURE__*/_jsx(MuiThemeProvider,{theme:createTheme(colors),children:/*#__PURE__*/_jsx(Paper,{children:/*#__PURE__*/_jsx(AceEditor,{ref:editorRef,...args})})})});};export default withStreamlitConnection(Ace);","map":{"version":3,"names":["useEffect","useRef","useState","Streamlit","withStreamlitConnection","AceEditor","Paper","MuiThemeProvider","createTheme","jsx","_jsx","Ace","_ref","args","theme","colors","setColors","changed","setChanged","editorRef","debounceRef","timeout","updateStreamlit","value","setComponentValue","toUpperCase","handleChange","clearTimeout","setTimeout","autoUpdate","current","editor","commands","removeCommand","addCommand","name","bindKey","mac","win","exec","selection","clearSelection","navigateLineEnd","insert","getValue","completer","Array","isArray","customCompleter","getCompletions","session","pos","prefix","callback","results","filter","item","includes","map","caption","meta","completers","push","forEach","original","call","err","palette","primary","main","primaryColor","background","default","backgroundColor","text","textColor","enableBasicAutocompletion","enableLiveAutocompletion","onChange","width","height","maxLines","Infinity","resizeObserver","ResizeObserver","entries","setFrameHeight","contentRect","observeElement","element","observe","disconnect","ref","children"],"sources":["C:/Users/jean9/Desktop/projeto_rm/components/streamlit_ace/frontend/src/Ace.tsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\"\nimport {\n  ComponentProps,\n  Streamlit,\n  withStreamlitConnection,\n  Theme,\n} from \"streamlit-component-lib\"\nimport AceEditor from \"react-ace\"\nimport { IAceEditor } from \"react-ace/lib/types\"\nimport { Paper, Button, Grid } from \"@material-ui/core\"\nimport { MuiThemeProvider, createTheme } from \"@material-ui/core/styles\"\n\nimport \"ace-builds/webpack-resolver\"\nimport \"ace-builds/src-min-noconflict/ext-emmet\"\nimport \"ace-builds/src-min-noconflict/ext-language_tools\"\n\nimport \"./index.css\" // Aqui estÃ¡ o estilo visual para deixar o texto em maiÃºsculo\n\ninterface AceProps extends ComponentProps {\n  args: any\n  theme?: Theme\n}\n\nconst Ace = ({ args, theme }: AceProps) => {\n  const [colors, setColors] = useState<any>({})\n  const [changed, setChanged] = useState<boolean>(false)\n  const editorRef = useRef<IAceEditor>(null)\n  const debounceRef = useRef<number>(0)\n\n  let timeout: NodeJS.Timeout\n\n  // Send editor content to streamlit\n  const updateStreamlit = (value: string) => {\n    Streamlit.setComponentValue(value.toUpperCase()) // forÃ§a o valor em maiÃºsculo\n    setChanged(false)\n  }\n\n  // Called on editor update\n  const handleChange = (value: string) => {\n    clearTimeout(timeout)\n\n    timeout = setTimeout(() => {\n      if (args.autoUpdate) {\n        updateStreamlit(value)\n      }\n      else {\n        setChanged(true)\n      }\n    }, debounceRef.current)\n  }\n\n  // Update content keybinding\n  useEffect(() => {\n    if (editorRef.current) {\n      const editor = editorRef.current.editor\n\n      editor.commands.removeCommand(\"addLineAfter\")\n      editor.commands.addCommand({\n        name: \"updateStreamlit\",\n        bindKey: {mac: \"cmd-return\", win: \"ctrl-return\"},\n        exec: (editor: IAceEditor) => {\n          if (args.autoUpdate) {\n            editor.selection.clearSelection();\n            editor.navigateLineEnd();\n            editor.insert(\"\\n\");\n          }\n          else if (changed) {\n            updateStreamlit(editor.getValue())\n          }\n        }\n      })\n\n      debounceRef.current = args.autoUpdate ? 200 : 0\n\n      // ðŸ‘‡ Completer customizado com filtro por prefixo\n      if (args.completer && Array.isArray(args.completer)) {\n  const customCompleter = {\n    getCompletions: function (editor: any, session: any, pos: any, prefix: any, callback: any) {\n      const results = args.completer\n        .filter((item: any) => {\n          if (!prefix) return true;  // se nÃ£o houver prefixo, mostra tudo\n          return (item.value || \"\").toUpperCase().includes(prefix.toUpperCase())\n        })\n        .map((item: any) => ({\n          value: item.value,\n          caption: item.value,\n          meta: item.meta || \"custom\"\n        }))\n\n      callback(null, results)\n    }\n  }\n\n  // Adiciona o completer personalizado Ã  lista de completers existentes\n  if (editor.completers && Array.isArray(editor.completers)) {\n    editor.completers.push(customCompleter)\n  } else {\n    editor.completers = [customCompleter]\n  }\n}\n\n// ðŸ”  ForÃ§a sugestÃµes em maiÃºsculo (inclusive nativas se houver)\neditor.completers.forEach((completer: any) => {\n  const original = completer.getCompletions\n  completer.getCompletions = function (editor: any, session: any, pos: any, prefix: any, callback: any) {\n    original.call(this, editor, session, pos, prefix, function (err: any, results: any) {\n      if (results) {\n        results.forEach((item: any) => {\n          item.value = item.value.toUpperCase()\n          if (item.caption) item.caption = item.caption.toUpperCase()\n        })\n      }\n      callback(err, results)\n    })\n  }\n})\n\n    }\n  }, [])\n\n  // Update theme\n  useEffect(() => {\n    setColors({\n      palette: {\n        primary: {\n          main: theme?.primaryColor,\n          background: {\n            default: theme?.backgroundColor,\n          },\n          text: {\n            primary: theme?.textColor,\n          }\n        }\n      }\n    })\n  }, [theme?.primaryColor, theme?.backgroundColor, theme?.textColor])\n\n\n  // Set default prop values that shouldn't be exposed to python\n  args.enableBasicAutocompletion = true\n  args.enableLiveAutocompletion = true\n  args.onChange = handleChange\n  args.width = \"100%\"\n\n  // Auto height\n  if (!args.height) {\n    args.maxLines = Infinity\n  }\n\n  const resizeObserver = new ResizeObserver((entries: any) => {\n    Streamlit.setFrameHeight(entries[0].contentRect.height + 15)\n  })\n\n  const observeElement = (element: HTMLDivElement | null) => {\n    if (element !== null)\n      resizeObserver.observe(element)\n    else\n      resizeObserver.disconnect()\n  }\n\n  return (\n    <div ref={observeElement}>\n      <MuiThemeProvider theme={createTheme(colors)}>\n        <Paper>\n          <AceEditor ref={editorRef} {...args} />\n        </Paper>\n\n      </MuiThemeProvider>\n    </div>\n  )\n}\n\nexport default withStreamlitConnection(Ace)\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}